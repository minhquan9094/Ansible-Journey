# Ansible working with Windows

## Ansible connection 




### Module

##### Resource:

Using Pywinrm: https://pypi.org/project/pywinrm/



##### With Ansibleâ€™s native Windows support:
- Gather facts on Windows hosts
- Install and uninstall MSIs
- Enable and disable Windows features
- Start, stop, and manage Windows services
- Create and manage local users and groups
- Manage Windows packages via the Chocolatey package manager ( https://chocolatey.org/)
- Manage and install Windows updates
- Fetch files from remote sites
- Push and execute any PowerShell scripts you write

Note: *Modules for Windows are prefixed with win_, except for the setup module*

Resource for usecase: https://docs.ansible.com/ansible/latest/os_guide/windows_usage.html

```
- name: Manage tools directory
  win_file:
    path: 'C:/Tools'
    state: directory

```

###### Ansible connection variables

```
----
ansible_connection= "winrm"
ansible_user= "admin"
ansible_password= "aaa"
ansbile_winrm_transport= "basic"
ansible_winrm_server_cert_validation= ignore

```

```
# inventory file:

[winsrv]
192.168.92.225
10.10.137.14
192.168.92.220
10.10.137.8
10.10.137.13


[winsrv:vars]
ansible_user=
ansible_password=
ansible_port=5985
ansible_connection=winrm
ansible_winrm_transport=ntlm
#ansible_winrm_server_cert_validation=ignore
#ansible_winrm_scheme=http
#ansible_become_method=runas
#ansible_become_user=SYSTEM

```


```
Running command
ansible all -i inventory -m win_ping
```












